(function(e){"use strict";function r(e=a){return new Promise((r,t)=>{c(e).then(e=>{r(e.version),e.close()}).catch(e=>t(e))})}function t(e,t=null,n=null){return new Promise((a,s)=>{r(e).then(r=>{var c=o.open(e,r+1);c.onerror=(e=>s("Error in opening IndexedDB")),c.onupgradeneeded=(e=>{let r=e.target.result;if(t instanceof Object){if(Array.isArray(t)){let e={};t.forEach(r=>e[r]={}),t=e}for(let e in t){let n=r.createObjectStore(e,t[e].options||{});if(t[e].indexes instanceof Object)for(let r in t[e].indexes)n.createIndex(r,r,t[e].indexes||{})}}Array.isArray(n)&&n.forEach(e=>r.deleteObjectStore(e)),a("Database upgraded")}),c.onsuccess=(e=>e.target.result.close())}).catch(e=>s(e))})}const n=e;var a;const o=window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB,s=(window.IDBTransaction||window.webkitIDBTransaction||window.msIDBTransaction,window.IDBKeyRange||window.webkitIDBKeyRange||window.msIDBKeyRange);if(!o)return void console.error("Your browser doesn't support a stable version of IndexedDB.");n.setDefaultDB=(e=>a=e),Object.defineProperty(n,"default",{get:()=>a,set:e=>a=e}),n.initDB=function(e,r={}){return new Promise((n,s)=>{if(!(r instanceof Object))return s("ObjectStores must be an object or array");a=a||e;var c=o.open(e);c.onerror=(e=>s("Error in opening IndexedDB")),c.onsuccess=(a=>{var o=a.target.result;let c=Object.values(o.objectStoreNames);var u={},l={},i=[];if(Array.isArray(r))r.forEach(e=>u[e]={});else u=r;let d=Object.keys(u);for(let e of d)c.includes(e)||(l[e]=u[e]);for(let e of c)d.includes(e)||i.push(e);Object.keys(l).length||i.length?t(e,l,i).then(e=>n(e)).catch(e=>s(e)):n("Initiated IndexedDB"),o.close()})})};const c=n.openDB=function(e=a){return new Promise((r,t)=>{var n=o.open(e);n.onerror=(e=>t("Error in opening IndexedDB")),n.onupgradeneeded=(r=>{r.target.result.close(),u(e).then(e=>null).catch(e=>null).finally(e=>t("Datebase not found"))}),n.onsuccess=(e=>r(e.target.result))})},u=n.deleteDB=function(e=a){return new Promise((r,t)=>{var n=o.deleteDatabase(e);n.onerror=(e=>t("Error deleting database!")),n.onsuccess=(e=>r("Database deleted successfully"))})};n.writeData=function(e,r,t=!1,n=a){return new Promise((a,o)=>{c(n).then(n=>{var s=n.transaction(e,"readwrite").objectStore(e);let c=t?s.put(r,t):s.put(r);c.onsuccess=(e=>a("Write data Successful")),c.onerror=(e=>o(`Write data unsuccessful [${e.target.error.name}] ${e.target.error.message}`)),n.close()}).catch(e=>o(e))})},n.addData=function(e,r,t=!1,n=a){return new Promise((a,o)=>{c(n).then(n=>{var s=n.transaction(e,"readwrite").objectStore(e);let c=t?s.add(r,t):s.add(r);c.onsuccess=(e=>a("Add data successful")),c.onerror=(e=>o(`Add data unsuccessful [${e.target.error.name}] ${e.target.error.message}`)),n.close()}).catch(e=>o(e))})},n.removeData=function(e,r,t=a){return new Promise((n,a)=>{c(t).then(t=>{var o=t.transaction(e,"readwrite").objectStore(e);let s=o.delete(r);s.onsuccess=(e=>n(`Removed Data ${r}`)),s.onerror=(e=>a(`Remove data unsuccessful [${e.target.error.name}] ${e.target.error.message}`)),t.close()}).catch(e=>a(e))})},n.clearData=function(e,r=a){return new Promise((t,n)=>{c(r).then(r=>{var a=r.transaction(e,"readwrite").objectStore(e);let o=a.clear();o.onsuccess=(e=>t("Clear data Successful")),o.onerror=(e=>n("Clear data Unsuccessful")),r.close()}).catch(e=>n(e))})},n.readData=function(e,r,t=a){return new Promise((n,a)=>{c(t).then(t=>{var o=t.transaction(e,"readonly").objectStore(e);let s=o.get(r);s.onsuccess=(e=>n(e.target.result)),s.onerror=(e=>a(`Read data unsuccessful [${e.target.error.name}] ${e.target.error.message}`)),t.close()}).catch(e=>a(e))})},n.readAllData=function(e,r=a){return new Promise((t,n)=>{c(r).then(r=>{var a=r.transaction(e,"readonly").objectStore(e),o={};let s=a.openCursor();s.onsuccess=(e=>{var r=e.target.result;r?(o[r.primaryKey]=r.value,r.continue()):t(o)}),s.onerror=(e=>n(`Read-All data unsuccessful [${e.target.error.name}] ${e.target.error.message}`)),r.close()}).catch(e=>n(e))})},n.searchData=function(e,r={},t=a){return r.lowerKey=r.atKey||r.lowerKey||0,r.upperKey=r.atKey||r.upperKey||!1,r.patternEval=r.patternEval||((e,r)=>!0),r.limit=r.limit||!1,r.lastOnly=r.lastOnly||!1,new Promise((n,a)=>{c(t).then(t=>{var o=t.transaction(e,"readonly").objectStore(e),c={};let u=o.openCursor(r.upperKey?s.bound(r.lowerKey,r.upperKey):s.lowerBound(r.lowerKey),r.lastOnly?"prev":"next");u.onsuccess=(e=>{var t=e.target.result;t?r.patternEval(t.primaryKey,t.value)?(c[t.primaryKey]=t.value,r.lastOnly?n(c):t.continue()):t.continue():n(c)}),u.onerror=(e=>a(`Search unsuccessful [${e.target.error.name}] ${e.target.error.message}`)),t.close()}).catch(e=>a(e))})}})(window.compactIDB={});